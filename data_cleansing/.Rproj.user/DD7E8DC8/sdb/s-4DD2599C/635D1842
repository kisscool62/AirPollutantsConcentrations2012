{
    "contents" : "library(dplyr)\n\nraw_csv <- list.files('../data/raw_csv/', pattern = \".*_station_statistics-Tableau.*.csv\", full.names = T)\n\nread_raw_csv <- function(path){\n    var_name <- gsub(x=path, pattern=\"\\\\.\\\\./data/raw_csv//(.*)_station_statistics-Tableau.*\", replacement = \"\\\\1\")\n    temp <- read.csv2(path, skip=10, quote=\"\")\n    temp <- temp[temp$statistics_year == 2012, ]\n#     group_by(temp, city_name)\n\n    assign(var_name, temp, envir = .GlobalEnv)\n\n    c(length(unique(get(var_name)$city_name)), length(get(var_name)$city_name))\n}\n\nlapply(raw_csv, FUN=read_raw_csv)\n\nbap_eur <- unique(as.character(BaP$station_european_code))\nno2_eur <- unique(as.character(NO2$station_european_code))\no3_eur <- unique(as.character(O3$station_european_code))\npm10_eur <- unique(as.character(PM10$station_european_code))\npm2.5_eur <- unique(as.character(PM2.5$station_european_code))\n\nPM10_d <- subset(PM10, select=c(country_iso_code, country_name, city_name, UA_city_pop, percentage_traffic_population, percentage_background_population, station_european_code, type_of_station, station_type_of_area, count_type_by_city, assigned_population, statistic_value, statistics_percentage_valid, above_DLV. ))\n\nPM2.5_d <- subset(PM2.5, select=c(station_european_code, statistic_value, statistics_percentage_valid, above_TV. ))\n\nO3_d <- subset(O3, select=c(station_european_code, statistic_value, statistics_percentage_valid, above_TV. ))\n\nNO2_d <- subset(NO2, select=c(station_european_code, statistic_value, statistics_percentage_valid, above_LV. ))\n\nBaP_d <- subset(BaP, select=c(station_european_code, statistic_value, statistics_percentage_valid, above_TV. ))\n\npollutants <- merge(\n    x = PM10_d,\n    y = NO2_d,\n    by.x = \"station_european_code\",\n    by.y = \"station_european_code\")\n\npollutants <- mutate(\n    pollutants,\n    PM10=statistic_value.x,\n    NO2=statistic_value.y,\n    PM10above_DLV. = above_DLV.,\n    NO2above_LV. = above_LV.,\n    PM10statistics_percentage_valid = statistics_percentage_valid.x,\n    NO2statistics_percentage_valid = statistics_percentage_valid.y)\n\npollutants <- subset(\n    pollutants,\n    select=-c(\n        statistic_value.x, statistic_value.y,\n        above_DLV., above_LV.,\n        statistics_percentage_valid.x, statistics_percentage_valid.y))\n\npollutants <- merge(\n    x = pollutants,\n    y = PM2.5_d,\n    by.x = \"station_european_code\",\n    by.y = \"station_european_code\")\n\npollutants <- mutate(\n    pollutants,\n    PM2.5=statistic_value,\n    PM2.5above_TV. = above_TV.,\n    PM2.5statistics_percentage_valid = statistics_percentage_valid)\n\npollutants <- subset(\n    pollutants,\n    select=-c(\n        statistic_value,\n        above_TV.,\n        statistics_percentage_valid))\n\n\npollutants <- merge(\n    x = pollutants,\n    y = O3_d,\n    by.x = \"station_european_code\",\n    by.y = \"station_european_code\")\n\npollutants <- mutate(\n    pollutants,\n    O3=statistic_value,\n    O3above_TV. = above_TV.,\n    O3statistics_percentage_valid = statistics_percentage_valid)\n\npollutants <- subset(\n    pollutants,\n    select=-c(\n        statistic_value,\n        above_TV.,\n        statistics_percentage_valid))\n\npollutants <- merge(\n    x = pollutants,\n    y = BaP_d,\n    by.x = \"station_european_code\",\n    by.y = \"station_european_code\")\n\npollutants <- mutate(\n    pollutants,\n    BaP=statistic_value,\n    BaPabove_TV. = above_TV.,\n    BaPstatistics_percentage_valid = statistics_percentage_valid)\n\n\npollutants <- subset(\n    pollutants,\n    select=-c(\n        statistic_value,\n        above_TV.,\n        statistics_percentage_valid))\n\n\nis_above <- function(x){\n    x == 0\n}\n\npollutants_concentrations <- mutate(\n    pollutants,\n    BaPabove_TV. = is_above(BaPabove_TV.),\n    O3above_TV. = is_above(O3above_TV.),\n    PM10above_DLV. = is_above(PM10above_DLV.),\n    PM2.5above_TV. = is_above(PM2.5above_TV.),\n    NO2above_LV. = is_above(NO2above_LV.))\n\n\n\n\n",
    "created" : 1449930829999.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1576534894",
    "id" : "635D1842",
    "lastKnownWriteTime" : 1450297544,
    "path" : "~/workspace/projects/PollutantsContentrations/data_cleansing/build_data.R",
    "project_path" : "build_data.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}